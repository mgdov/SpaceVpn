{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Documents/programming/pixel-space-vpn/components/pixel-stars.tsx"],"sourcesContent":["\"use client\"\n\nimport { useEffect, useState } from \"react\"\n\ninterface Star {\n  id: number\n  x: number\n  y: number\n  size: number\n  delay: number\n  type: \"dot\" | \"cross\"\n}\n\nexport function PixelStars() {\n  const [stars, setStars] = useState<Star[]>([])\n\n  useEffect(() => {\n    const generateStars = () => {\n      const newStars: Star[] = []\n      for (let i = 0; i < 100; i++) {\n        newStars.push({\n          id: i,\n          x: Math.random() * 100,\n          y: Math.random() * 100,\n          size: Math.random() > 0.8 ? 2 : 1,\n          delay: Math.random() * 3,\n          type: Math.random() > 0.7 ? \"cross\" : \"dot\",\n        })\n      }\n      setStars(newStars)\n    }\n    generateStars()\n  }, [])\n\n  return (\n    <div className=\"fixed inset-0 overflow-hidden pointer-events-none z-0\">\n      {stars.map((star) => (\n        <div\n          key={star.id}\n          className=\"absolute star\"\n          style={{\n            left: `${star.x}%`,\n            top: `${star.y}%`,\n            animationDelay: `${star.delay}s`,\n          }}\n        >\n          {star.type === \"cross\" ? (\n            <div className=\"text-blue-300 text-opacity-60\" style={{ fontSize: `${star.size * 6}px` }}>\n              +\n            </div>\n          ) : (\n            <div\n              className=\"bg-cyan-300 rounded-none\"\n              style={{\n                width: `${star.size * 2}px`,\n                height: `${star.size * 2}px`,\n              }}\n            />\n          )}\n        </div>\n      ))}\n    </div>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AAaO,SAAS;IACd,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,sQAAQ,EAAS,EAAE;IAE7C,IAAA,uQAAS,EAAC;QACR,MAAM,gBAAgB;YACpB,MAAM,WAAmB,EAAE;YAC3B,IAAK,IAAI,IAAI,GAAG,IAAI,KAAK,IAAK;gBAC5B,SAAS,IAAI,CAAC;oBACZ,IAAI;oBACJ,GAAG,KAAK,MAAM,KAAK;oBACnB,GAAG,KAAK,MAAM,KAAK;oBACnB,MAAM,KAAK,MAAM,KAAK,MAAM,IAAI;oBAChC,OAAO,KAAK,MAAM,KAAK;oBACvB,MAAM,KAAK,MAAM,KAAK,MAAM,UAAU;gBACxC;YACF;YACA,SAAS;QACX;QACA;IACF,GAAG,EAAE;IAEL,qBACE,mSAAC;QAAI,WAAU;kBACZ,MAAM,GAAG,CAAC,CAAC,qBACV,mSAAC;gBAEC,WAAU;gBACV,OAAO;oBACL,MAAM,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;oBAClB,KAAK,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;oBACjB,gBAAgB,GAAG,KAAK,KAAK,CAAC,CAAC,CAAC;gBAClC;0BAEC,KAAK,IAAI,KAAK,wBACb,mSAAC;oBAAI,WAAU;oBAAgC,OAAO;wBAAE,UAAU,GAAG,KAAK,IAAI,GAAG,EAAE,EAAE,CAAC;oBAAC;8BAAG;;;;;yCAI1F,mSAAC;oBACC,WAAU;oBACV,OAAO;wBACL,OAAO,GAAG,KAAK,IAAI,GAAG,EAAE,EAAE,CAAC;wBAC3B,QAAQ,GAAG,KAAK,IAAI,GAAG,EAAE,EAAE,CAAC;oBAC9B;;;;;;eAlBC,KAAK,EAAE;;;;;;;;;;AAyBtB"}},
    {"offset": {"line": 77, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Documents/programming/pixel-space-vpn/lib/api/subscriptions.ts"],"sourcesContent":["/**\n * Subscriptions API endpoints\n */\n\nimport { fetchAPI } from './client'\nimport type {\n  ApiResponse,\n  MySubscriptionsResponse,\n  PurchaseFreeTariffRequest,\n  PurchaseFreeTariffResponse,\n} from '@/types/api'\n\n/**\n * Получить мои подписки\n */\nexport async function getMySubscriptions(): Promise<ApiResponse<MySubscriptionsResponse>> {\n  return fetchAPI<MySubscriptionsResponse>('/subscriptions/my')\n}\n\n/**\n * Покупка бесплатного тарифа (создание подписки и VPN ключа)\n */\nexport async function purchaseFreeTariff(\n  data: PurchaseFreeTariffRequest\n): Promise<ApiResponse<PurchaseFreeTariffResponse>> {\n  return fetchAPI<PurchaseFreeTariffResponse>('/subscriptions/purchase-free', {\n    method: 'POST',\n    body: JSON.stringify(data),\n  })\n}\n"],"names":[],"mappings":"AAAA;;CAEC;;;;;;AAED;;AAWO,eAAe;IACpB,OAAO,IAAA,qLAAQ,EAA0B;AAC3C;AAKO,eAAe,mBACpB,IAA+B;IAE/B,OAAO,IAAA,qLAAQ,EAA6B,gCAAgC;QAC1E,QAAQ;QACR,MAAM,KAAK,SAAS,CAAC;IACvB;AACF"}},
    {"offset": {"line": 100, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Documents/programming/pixel-space-vpn/lib/api/tariffs.ts"],"sourcesContent":["/**\n * Tariffs API endpoints (public, authenticated)\n */\n\nimport { fetchAPI } from './client'\nimport type { ApiResponse, Tariff } from '@/types/api'\n\n/**\n * Получить список активных тарифов (для сайта, авторизация не обязательна для публичных)\n */\nexport async function getPublicTariffs(): Promise<ApiResponse<Tariff[]>> {\n  return fetchAPI<Tariff[]>('/tariffs/')\n}\n\n/**\n * Получить тариф по ID\n */\nexport async function getPublicTariffById(id: string | number): Promise<ApiResponse<Tariff>> {\n  return fetchAPI<Tariff>(`/tariffs/${id}`)\n}\n"],"names":[],"mappings":"AAAA;;CAEC;;;;;;AAED;;AAMO,eAAe;IACpB,OAAO,IAAA,qLAAQ,EAAW;AAC5B;AAKO,eAAe,oBAAoB,EAAmB;IAC3D,OAAO,IAAA,qLAAQ,EAAS,CAAC,SAAS,EAAE,IAAI;AAC1C"}},
    {"offset": {"line": 120, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Documents/programming/pixel-space-vpn/lib/api/plans.ts"],"sourcesContent":["/**\n * Plans API (simplified tariffs: id, name, days, price)\n */\n\nimport { fetchAPI } from './client'\nimport type { ApiResponse, Plan } from '@/types/api'\n\n/**\n * Получить список планов (активные тарифы в формате id, name, days, price)\n */\nexport async function getPlans(): Promise<ApiResponse<Plan[]>> {\n  return fetchAPI<Plan[]>('/plans')\n}\n"],"names":[],"mappings":"AAAA;;CAEC;;;;AAED;;AAMO,eAAe;IACpB,OAAO,IAAA,qLAAQ,EAAS;AAC1B"}},
    {"offset": {"line": 135, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Documents/programming/pixel-space-vpn/lib/api/public-api.ts"],"sourcesContent":["/**\n * Public API endpoints (без авторизации)\n */\n\nimport { fetchAPI } from './client'\nimport type {\n  ApiResponse,\n  PublicTariffsResponse,\n  KeySearchRequest,\n  KeySearchResult,\n  CreateKeyRequest,\n  CreateKeyResult,\n  RenewKeyRequest,\n  RenewKeyResult,\n  KeyByPaymentResponse,\n} from '@/types/api'\n\n/**\n * Получить список активных тарифов (PUBLIC)\n */\nexport async function getPublicTariffs(): Promise<ApiResponse<PublicTariffsResponse>> {\n  return fetchAPI<PublicTariffsResponse>('/public/tariffs')\n}\n\n/**\n * Поиск ключа по идентификатору\n */\nexport async function searchKey(keyIdentifier: string): Promise<ApiResponse<KeySearchResult>> {\n  return fetchAPI<KeySearchResult>('/public/key/search', {\n    method: 'POST',\n    body: JSON.stringify({ key_identifier: keyIdentifier } as KeySearchRequest),\n  })\n}\n\n/**\n * Создать ключ без регистрации\n */\nexport async function createKeyPublic(request: CreateKeyRequest): Promise<ApiResponse<CreateKeyResult>> {\n  return fetchAPI<CreateKeyResult>('/public/key/create', {\n    method: 'POST',\n    body: JSON.stringify(request),\n  })\n}\n\n/**\n * Продлить ключ\n */\nexport async function renewKey(request: RenewKeyRequest): Promise<ApiResponse<RenewKeyResult>> {\n  return fetchAPI<RenewKeyResult>('/public/key/renew', {\n    method: 'POST',\n    body: JSON.stringify(request),\n  })\n}\n\n/**\n * Получить ключ по ID платежа (с polling)\n * Используется после оплаты для получения ключа\n */\nexport async function getKeyByPayment(paymentId: string): Promise<ApiResponse<KeyByPaymentResponse>> {\n  return fetchAPI<KeyByPaymentResponse>(`/public/key/by-payment/${paymentId}`)\n}\n\n/**\n * Polling ключа после оплаты\n * Проверяет статус каждые 2 секунды до 15 раз (30 секунд)\n */\nexport async function pollKeyByPayment(\n  paymentId: string,\n  maxAttempts: number = 15,\n  intervalMs: number = 2000\n): Promise<ApiResponse<KeyByPaymentResponse>> {\n  for (let i = 0; i < maxAttempts; i++) {\n    const response = await getKeyByPayment(paymentId)\n\n    if (response.status === 200 && response.data) {\n      return response\n    }\n\n    if (response.status !== 202) {\n      return response\n    }\n\n    if (i < maxAttempts - 1) {\n      await new Promise(resolve => setTimeout(resolve, intervalMs))\n    }\n  }\n\n  return { error: 'Timeout: не удалось получить ключ после оплаты' }\n}\n"],"names":[],"mappings":"AAAA;;CAEC;;;;;;;;;;;;;;AAED;;AAgBO,eAAe;IACpB,OAAO,IAAA,qLAAQ,EAAwB;AACzC;AAKO,eAAe,UAAU,aAAqB;IACnD,OAAO,IAAA,qLAAQ,EAAkB,sBAAsB;QACrD,QAAQ;QACR,MAAM,KAAK,SAAS,CAAC;YAAE,gBAAgB;QAAc;IACvD;AACF;AAKO,eAAe,gBAAgB,OAAyB;IAC7D,OAAO,IAAA,qLAAQ,EAAkB,sBAAsB;QACrD,QAAQ;QACR,MAAM,KAAK,SAAS,CAAC;IACvB;AACF;AAKO,eAAe,SAAS,OAAwB;IACrD,OAAO,IAAA,qLAAQ,EAAiB,qBAAqB;QACnD,QAAQ;QACR,MAAM,KAAK,SAAS,CAAC;IACvB;AACF;AAMO,eAAe,gBAAgB,SAAiB;IACrD,OAAO,IAAA,qLAAQ,EAAuB,CAAC,uBAAuB,EAAE,WAAW;AAC7E;AAMO,eAAe,iBACpB,SAAiB,EACjB,cAAsB,EAAE,EACxB,aAAqB,IAAI;IAEzB,IAAK,IAAI,IAAI,GAAG,IAAI,aAAa,IAAK;QACpC,MAAM,WAAW,MAAM,gBAAgB;QAEvC,IAAI,SAAS,MAAM,KAAK,OAAO,SAAS,IAAI,EAAE;YAC5C,OAAO;QACT;QAEA,IAAI,SAAS,MAAM,KAAK,KAAK;YAC3B,OAAO;QACT;QAEA,IAAI,IAAI,cAAc,GAAG;YACvB,MAAM,IAAI,QAAQ,CAAA,UAAW,WAAW,SAAS;QACnD;IACF;IAEA,OAAO;QAAE,OAAO;IAAiD;AACnE"}},
    {"offset": {"line": 200, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Documents/programming/pixel-space-vpn/lib/api/payments.ts"],"sourcesContent":["/**\n * Payment API endpoints\n */\n\nimport { fetchAPI, getAuthToken } from './client'\nimport type {\n  ApiResponse,\n  CreatePaymentRequest,\n  CreatePaymentResponse,\n  Payment,\n  Subscription,\n} from '@/types/api'\n\nexport interface CreateYookassaPaymentPayload {\n  tariffId: number\n  plan: string\n  price: number\n  description?: string\n}\n\nexport interface CreateYookassaPaymentResponse {\n  payment_id: number | string\n  confirmation_url?: string | null\n  status?: string\n}\n\nexport interface ConfirmYookassaPaymentResponse {\n  success: boolean\n  plan?: string\n  subscription?: Subscription\n  message?: string\n}\n\n/**\n * Создать платеж\n */\nexport async function createPayment(request: CreatePaymentRequest): Promise<ApiResponse<CreatePaymentResponse>> {\n  return fetchAPI<CreatePaymentResponse>('/payments/create', {\n    method: 'POST',\n    body: JSON.stringify(request),\n  })\n}\n\n/**\n * Получить статус платежа\n */\nexport async function getPaymentStatus(paymentId: string): Promise<ApiResponse<Payment>> {\n  return fetchAPI<Payment>(`/payments/${paymentId}`)\n}\n\n/**\n * YooKassa: создать платёж через backend /payments/create с return_url на account/keys\n */\nexport async function createYookassaPayment(\n  payload: CreateYookassaPaymentPayload\n): Promise<ApiResponse<CreateYookassaPaymentResponse>> {\n  const returnUrl =\n    (typeof window !== 'undefined' ? window.location.origin : '') +\n    `/account/keys?tariff_id=${encodeURIComponent(String(payload.tariffId))}&plan=${encodeURIComponent(payload.plan)}`\n  return createPayment({\n    tariff_id: payload.tariffId,\n    return_url: returnUrl,\n  })\n}\n\n/**\n * YooKassa: подтвердить платёж через Next.js route /api/yookassa/confirm-payment\n */\nexport async function confirmYookassaPayment(\n  paymentId: string\n): Promise<ApiResponse<ConfirmYookassaPaymentResponse>> {\n  const token = getAuthToken()\n  if (!token) {\n    return { error: 'Требуется авторизация для оплаты' }\n  }\n  try {\n    const response = await fetch('/api/yookassa/confirm-payment', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        Authorization: `Bearer ${token}`,\n      },\n      body: JSON.stringify({ paymentId }),\n    })\n    const data = await response.json().catch(() => ({}))\n    if (!response.ok) {\n      return { error: (data as any)?.error || (data as any)?.message || `HTTP ${response.status}` }\n    }\n    return { data }\n  } catch (error) {\n    return { error: error instanceof Error ? error.message : 'Network error' }\n  }\n}\n\n/**\n * YooKassa flow: создать платёж и при наличии confirmation_url перенаправить на него\n */\nexport async function initiatePayment(\n  tariffId: number,\n  returnUrl?: string\n): Promise<ApiResponse<CreatePaymentResponse>> {\n  const response = await createPayment({\n    tariff_id: tariffId,\n    return_url: returnUrl || (typeof window !== 'undefined' ? window.location.origin + '/account/keys' : undefined),\n  })\n  if (response.data?.confirmation_url && typeof window !== 'undefined') {\n    window.location.href = response.data.confirmation_url\n  }\n  return response\n}\n"],"names":[],"mappings":"AAAA;;CAEC;;;;;;;;;;;;AAED;;AAgCO,eAAe,cAAc,OAA6B;IAC/D,OAAO,IAAA,qLAAQ,EAAwB,oBAAoB;QACzD,QAAQ;QACR,MAAM,KAAK,SAAS,CAAC;IACvB;AACF;AAKO,eAAe,iBAAiB,SAAiB;IACtD,OAAO,IAAA,qLAAQ,EAAU,CAAC,UAAU,EAAE,WAAW;AACnD;AAKO,eAAe,sBACpB,OAAqC;IAErC,MAAM,YACJ,CAAC,sCAAgC,0BAAyB,EAAE,IAC5D,CAAC,wBAAwB,EAAE,mBAAmB,OAAO,QAAQ,QAAQ,GAAG,MAAM,EAAE,mBAAmB,QAAQ,IAAI,GAAG;IACpH,OAAO,cAAc;QACnB,WAAW,QAAQ,QAAQ;QAC3B,YAAY;IACd;AACF;AAKO,eAAe,uBACpB,SAAiB;IAEjB,MAAM,QAAQ,IAAA,yLAAY;IAC1B,IAAI,CAAC,OAAO;QACV,OAAO;YAAE,OAAO;QAAmC;IACrD;IACA,IAAI;QACF,MAAM,WAAW,MAAM,MAAM,iCAAiC;YAC5D,QAAQ;YACR,SAAS;gBACP,gBAAgB;gBAChB,eAAe,CAAC,OAAO,EAAE,OAAO;YAClC;YACA,MAAM,KAAK,SAAS,CAAC;gBAAE;YAAU;QACnC;QACA,MAAM,OAAO,MAAM,SAAS,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAC,CAAC;QAClD,IAAI,CAAC,SAAS,EAAE,EAAE;YAChB,OAAO;gBAAE,OAAO,AAAC,MAAc,SAAU,MAAc,WAAW,CAAC,KAAK,EAAE,SAAS,MAAM,EAAE;YAAC;QAC9F;QACA,OAAO;YAAE;QAAK;IAChB,EAAE,OAAO,OAAO;QACd,OAAO;YAAE,OAAO,iBAAiB,QAAQ,MAAM,OAAO,GAAG;QAAgB;IAC3E;AACF;AAKO,eAAe,gBACpB,QAAgB,EAChB,SAAkB;IAElB,MAAM,WAAW,MAAM,cAAc;QACnC,WAAW;QACX,YAAY,aAAa,CAAC,sCAAgC,0BAA2C,SAAS;IAChH;IACA,IAAI,SAAS,IAAI,EAAE,oBAAoB,kDAAkB;;IAGzD,OAAO;AACT"}},
    {"offset": {"line": 278, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Documents/programming/pixel-space-vpn/lib/api/vpn-keys.ts"],"sourcesContent":["/**\n * VPN Keys API endpoints\n */\n\nimport { fetchAPI } from './client'\nimport type {\n  ApiResponse,\n  VPNKeyStatus,\n  VPNKeyListResponse,\n  VPNClient,\n  ExtendKeyRequest,\n  ExtendKeyResponse,\n  HappDeeplinkResponse,\n  BypassPresetsResponse,\n  VPNConfig,\n  UpdateVPNClientPayload,\n  RegenerateVPNClientPayload,\n} from '@/types/api'\n\n// ============================================================================\n// VPN Keys (новый endpoint)\n// ============================================================================\n\n/**\n * Получить все VPN ключи текущего пользователя\n */\nexport async function getUserVPNKeys(): Promise<ApiResponse<VPNKeyListResponse>> {\n  return fetchAPI<VPNKeyListResponse>('/vpn-clients/keys')\n}\n\n/**\n * Получить VPN ключ по ID\n */\nexport async function getVPNKeyStatus(keyId: number): Promise<ApiResponse<VPNKeyStatus>> {\n  return fetchAPI<VPNKeyStatus>(`/vpn-clients/keys/${keyId}`)\n}\n\n/**\n * Продлить VPN ключ\n */\nexport async function extendVPNKey(\n  keyId: number,\n  request?: ExtendKeyRequest\n): Promise<ApiResponse<ExtendKeyResponse>> {\n  return fetchAPI<ExtendKeyResponse>(`/vpn-clients/keys/${keyId}/extend`, {\n    method: 'POST',\n    body: request ? JSON.stringify(request) : undefined,\n  })\n}\n\n/**\n * Получить Happ VPN deep link для ключа\n */\nexport async function getHappDeeplink(keyId: number): Promise<ApiResponse<HappDeeplinkResponse>> {\n  return fetchAPI<HappDeeplinkResponse>(`/vpn-clients/keys/${keyId}/happ-link`)\n}\n\n// ============================================================================\n// VPN Clients (старый endpoint)\n// ============================================================================\n\n/**\n * Получить всех VPN клиентов пользователя\n */\nexport async function getUserVPNClients(): Promise<ApiResponse<VPNClient[]>> {\n  return fetchAPI<VPNClient[]>('/vpn-clients')\n}\n\n/**\n * Получить VPN клиента по ID\n */\nexport async function getUserVPNClient(id: string): Promise<ApiResponse<VPNClient>> {\n  return fetchAPI<VPNClient>(`/vpn-clients/${id}`)\n}\n\n/**\n * Обновить VPN клиента\n */\nexport async function updateUserVPNClient(\n  id: string,\n  payload: UpdateVPNClientPayload\n): Promise<ApiResponse<VPNClient>> {\n  return fetchAPI<VPNClient>(`/vpn-clients/${id}`, {\n    method: 'PUT',\n    body: JSON.stringify(payload),\n  })\n}\n\n/**\n * Удалить VPN клиента\n */\nexport async function deleteUserVPNClient(id: string): Promise<ApiResponse<void>> {\n  return fetchAPI<void>(`/vpn-clients/${id}`, {\n    method: 'DELETE',\n  })\n}\n\n/**\n * Получить конфиг VPN клиента\n */\nexport async function getUserVPNClientConfig(id: string): Promise<ApiResponse<VPNConfig>> {\n  return fetchAPI<VPNConfig>(`/vpn-clients/${id}/config`)\n}\n\n/**\n * Регенерировать VPN клиента\n */\nexport async function regenerateUserVPNClient(\n  id: string,\n  payload?: RegenerateVPNClientPayload\n): Promise<ApiResponse<VPNConfig>> {\n  return fetchAPI<VPNConfig>(`/vpn-clients/${id}/regenerate`, {\n    method: 'POST',\n    body: payload ? JSON.stringify(payload) : undefined,\n  })\n}\n\n/**\n * Синхронизировать VPN клиента\n */\nexport async function syncUserVPNClient(id: string): Promise<ApiResponse<VPNClient>> {\n  return fetchAPI<VPNClient>(`/vpn-clients/${id}/sync`, {\n    method: 'POST',\n  })\n}\n\n/**\n * Получить доступные bypass пресеты\n */\nexport async function getBypassPresets(): Promise<ApiResponse<BypassPresetsResponse>> {\n  return fetchAPI<BypassPresetsResponse>('/vpn-clients/bypass-presets')\n}\n"],"names":[],"mappings":"AAAA;;CAEC;;;;;;;;;;;;;;;;;;;;;;;;;;AAED;;AAsBO,eAAe;IACpB,OAAO,IAAA,qLAAQ,EAAqB;AACtC;AAKO,eAAe,gBAAgB,KAAa;IACjD,OAAO,IAAA,qLAAQ,EAAe,CAAC,kBAAkB,EAAE,OAAO;AAC5D;AAKO,eAAe,aACpB,KAAa,EACb,OAA0B;IAE1B,OAAO,IAAA,qLAAQ,EAAoB,CAAC,kBAAkB,EAAE,MAAM,OAAO,CAAC,EAAE;QACtE,QAAQ;QACR,MAAM,UAAU,KAAK,SAAS,CAAC,WAAW;IAC5C;AACF;AAKO,eAAe,gBAAgB,KAAa;IACjD,OAAO,IAAA,qLAAQ,EAAuB,CAAC,kBAAkB,EAAE,MAAM,UAAU,CAAC;AAC9E;AASO,eAAe;IACpB,OAAO,IAAA,qLAAQ,EAAc;AAC/B;AAKO,eAAe,iBAAiB,EAAU;IAC/C,OAAO,IAAA,qLAAQ,EAAY,CAAC,aAAa,EAAE,IAAI;AACjD;AAKO,eAAe,oBACpB,EAAU,EACV,OAA+B;IAE/B,OAAO,IAAA,qLAAQ,EAAY,CAAC,aAAa,EAAE,IAAI,EAAE;QAC/C,QAAQ;QACR,MAAM,KAAK,SAAS,CAAC;IACvB;AACF;AAKO,eAAe,oBAAoB,EAAU;IAClD,OAAO,IAAA,qLAAQ,EAAO,CAAC,aAAa,EAAE,IAAI,EAAE;QAC1C,QAAQ;IACV;AACF;AAKO,eAAe,uBAAuB,EAAU;IACrD,OAAO,IAAA,qLAAQ,EAAY,CAAC,aAAa,EAAE,GAAG,OAAO,CAAC;AACxD;AAKO,eAAe,wBACpB,EAAU,EACV,OAAoC;IAEpC,OAAO,IAAA,qLAAQ,EAAY,CAAC,aAAa,EAAE,GAAG,WAAW,CAAC,EAAE;QAC1D,QAAQ;QACR,MAAM,UAAU,KAAK,SAAS,CAAC,WAAW;IAC5C;AACF;AAKO,eAAe,kBAAkB,EAAU;IAChD,OAAO,IAAA,qLAAQ,EAAY,CAAC,aAAa,EAAE,GAAG,KAAK,CAAC,EAAE;QACpD,QAAQ;IACV;AACF;AAKO,eAAe;IACpB,OAAO,IAAA,qLAAQ,EAAwB;AACzC"}},
    {"offset": {"line": 361, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Documents/programming/pixel-space-vpn/lib/api/admin.ts"],"sourcesContent":["/**\n * Admin API endpoints\n */\n\nimport { fetchAPI, withQuery } from './client'\nimport type {\n  ApiResponse,\n  User,\n  AdminVPNClient,\n  CreateVPNClientPayload,\n  UpdateVPNClientPayload,\n  Tariff,\n  CreateTariffPayload,\n  UpdateTariffPayload,\n  AdminFinanceStats,\n  AdminFinanceChartData,\n  AdminFinanceSummary,\n  AdminPayment,\n  AdminPaymentDetail,\n  AdminSubscription,\n  AdminCreateSubscriptionPayload,\n  ExtendPayload,\n  PaginationParams,\n  PaymentQueryParams,\n  PaymentListResponse,\n  TransactionQueryParams,\n} from '@/types/api'\n\n// ============================================================================\n// Admin Users\n// ============================================================================\n\n/**\n * Получить список пользователей\n */\nexport async function adminListUsers(params?: PaginationParams): Promise<ApiResponse<User[]>> {\n  return fetchAPI<User[]>(withQuery('/admin/users', params as Record<string, any>))\n}\n\n/**\n * Получить пользователя по ID\n */\nexport async function adminGetUser(userId: number): Promise<ApiResponse<User>> {\n  return fetchAPI<User>(`/admin/users/${userId}`)\n}\n\n/**\n * Удалить пользователя\n */\nexport async function adminDeleteUser(userId: number): Promise<ApiResponse<void>> {\n  return fetchAPI<void>(`/admin/users/${userId}`, {\n    method: 'DELETE',\n  })\n}\n\n/**\n * Включить/выключить пользователя (toggle active)\n */\nexport async function adminToggleUserActive(userId: number): Promise<ApiResponse<User>> {\n  return fetchAPI<User>(`/admin/users/${userId}/toggle-active`, {\n    method: 'POST',\n  })\n}\n\n/**\n * Сделать пользователя суперюзером\n */\nexport async function adminMakeSuperuser(userId: number): Promise<ApiResponse<User>> {\n  return fetchAPI<User>(`/admin/users/${userId}/make-superuser`, {\n    method: 'POST',\n  })\n}\n\n/**\n * Применить план (тариф) к пользователю\n */\nexport async function adminApplyPlan(\n  userId: number,\n  planId: number\n): Promise<ApiResponse<User>> {\n  return fetchAPI<User>(`/admin/users/${userId}/apply_plan`, {\n    method: 'POST',\n    body: JSON.stringify({ plan_id: planId }),\n  })\n}\n\n// ============================================================================\n// Admin Subscriptions\n// ============================================================================\n\n/**\n * Список подписок\n */\nexport async function adminListSubscriptions(\n  params?: PaginationParams\n): Promise<ApiResponse<AdminSubscription[]>> {\n  return fetchAPI<AdminSubscription[]>(withQuery('/admin/subscriptions', params as Record<string, any>))\n}\n\n/**\n * Подписка по ID\n */\nexport async function adminGetSubscription(\n  subscriptionId: number\n): Promise<ApiResponse<AdminSubscription>> {\n  return fetchAPI<AdminSubscription>(`/admin/subscriptions/${subscriptionId}`)\n}\n\n/**\n * Создать подписку (user_id, tariff_id — query или body, бэк ожидает query)\n */\nexport async function adminCreateSubscription(\n  payload: AdminCreateSubscriptionPayload\n): Promise<ApiResponse<AdminSubscription>> {\n  return fetchAPI<AdminSubscription>(\n    withQuery('/admin/subscriptions/', payload as Record<string, any>),\n    { method: 'POST' }\n  )\n}\n\n/**\n * Удалить подписку\n */\nexport async function adminDeleteSubscription(\n  subscriptionId: number\n): Promise<ApiResponse<void>> {\n  return fetchAPI<void>(`/admin/subscriptions/${subscriptionId}`, {\n    method: 'DELETE',\n  })\n}\n\n/**\n * Продлить подписку на N дней\n */\nexport async function adminExtendSubscription(\n  subscriptionId: number,\n  days: number = 30\n): Promise<ApiResponse<AdminSubscription>> {\n  return fetchAPI<AdminSubscription>(\n    withQuery(`/admin/subscriptions/${subscriptionId}/extend`, { days }),\n    { method: 'POST' }\n  )\n}\n\n/**\n * Включить/выключить подписку (toggle)\n */\nexport async function adminToggleSubscription(\n  subscriptionId: number\n): Promise<ApiResponse<AdminSubscription>> {\n  return fetchAPI<AdminSubscription>(\n    `/admin/subscriptions/${subscriptionId}/toggle`,\n    { method: 'POST' }\n  )\n}\n\n// ============================================================================\n// Admin VPN Clients\n// ============================================================================\n\n// ============================================================================\n// Admin VPN Clients\n// ============================================================================\n\n/**\n * Получить список VPN клиентов\n */\nexport async function adminListVPNClients(params?: PaginationParams): Promise<ApiResponse<AdminVPNClient[]>> {\n  return fetchAPI<AdminVPNClient[]>(withQuery('/admin/vpn/clients', params as Record<string, any>))\n}\n\n/**\n * Получить VPN клиента по ID\n */\nexport async function adminGetVPNClient(clientId: number): Promise<ApiResponse<AdminVPNClient>> {\n  return fetchAPI<AdminVPNClient>(`/admin/vpn/clients/${clientId}`)\n}\n\n/**\n * Создать VPN клиента\n */\nexport async function adminCreateVPNClient(\n  payload: CreateVPNClientPayload\n): Promise<ApiResponse<AdminVPNClient>> {\n  return fetchAPI<AdminVPNClient>('/admin/vpn/clients', {\n    method: 'POST',\n    body: JSON.stringify(payload),\n  })\n}\n\n/**\n * Обновить VPN клиента\n */\nexport async function adminUpdateVPNClient(\n  id: number,\n  payload: UpdateVPNClientPayload\n): Promise<ApiResponse<AdminVPNClient>> {\n  return fetchAPI<AdminVPNClient>(`/admin/vpn/clients/${id}`, {\n    method: 'PUT',\n    body: JSON.stringify(payload),\n  })\n}\n\n/**\n * Удалить VPN клиента\n */\nexport async function adminDeleteVPNClient(id: number): Promise<ApiResponse<void>> {\n  return fetchAPI<void>(`/admin/vpn/clients/${id}`, {\n    method: 'DELETE',\n  })\n}\n\n/**\n * Продлить VPN клиента (days или expires_at)\n */\nexport async function adminExtendVPNClient(\n  clientId: number,\n  payload?: ExtendPayload\n): Promise<ApiResponse<AdminVPNClient>> {\n  return fetchAPI<AdminVPNClient>(`/admin/vpn/clients/${clientId}/extend`, {\n    method: 'POST',\n    body: payload ? JSON.stringify(payload) : undefined,\n  })\n}\n\n/**\n * Включить/выключить VPN клиента (toggle)\n */\nexport async function adminToggleVPNClient(\n  clientId: number\n): Promise<ApiResponse<AdminVPNClient>> {\n  return fetchAPI<AdminVPNClient>(`/admin/vpn/clients/${clientId}/toggle`, {\n    method: 'POST',\n  })\n}\n\n// ============================================================================\n// Admin Tariffs\n// ============================================================================\n\n/**\n * Получить список тарифов\n */\nexport async function adminListTariffs(params?: PaginationParams): Promise<ApiResponse<Tariff[]>> {\n  return fetchAPI<Tariff[]>(withQuery('/admin/tariffs', params as Record<string, any>))\n}\n\n/**\n * Создать тариф\n */\nexport async function adminCreateTariff(payload: CreateTariffPayload): Promise<ApiResponse<Tariff>> {\n  return fetchAPI<Tariff>('/admin/tariffs', {\n    method: 'POST',\n    body: JSON.stringify(payload),\n  })\n}\n\n/**\n * Обновить тариф\n */\nexport async function adminUpdateTariff(id: number, payload: UpdateTariffPayload): Promise<ApiResponse<Tariff>> {\n  return fetchAPI<Tariff>(`/admin/tariffs/${id}`, {\n    method: 'PATCH',\n    body: JSON.stringify(payload),\n  })\n}\n\n/**\n * Удалить тариф\n */\nexport async function adminDeleteTariff(id: number): Promise<ApiResponse<void>> {\n  return fetchAPI<void>(`/admin/tariffs/${id}`, {\n    method: 'DELETE',\n  })\n}\n\n/**\n * Включить/выключить тариф (toggle)\n */\nexport async function adminToggleTariff(id: number): Promise<ApiResponse<Tariff>> {\n  return fetchAPI<Tariff>(`/admin/tariffs/${id}/toggle`, {\n    method: 'POST',\n  })\n}\n\n// ============================================================================\n// Admin Finance\n// ============================================================================\n\n/**\n * Получить финансовую статистику\n */\nexport async function getAdminFinanceStats(): Promise<ApiResponse<AdminFinanceStats>> {\n  return fetchAPI<AdminFinanceStats>('/admin/finance/stats')\n}\n\n/**\n * Получить данные для графика\n */\nexport async function getAdminFinanceChart(\n  period: '7days' | '30days' | '12months'\n): Promise<ApiResponse<AdminFinanceChartData>> {\n  return fetchAPI<AdminFinanceChartData>(`/admin/finance/chart/${period}`)\n}\n\n/**\n * Получить историю платежей\n */\nexport async function getAdminPayments(params?: PaymentQueryParams): Promise<ApiResponse<AdminPayment[]>> {\n  return fetchAPI<AdminPayment[]>(withQuery('/admin/finance/payments', params as Record<string, any>))\n}\n\n/**\n * Детали платежа (с user, tariff)\n */\nexport async function getAdminPaymentDetails(\n  paymentId: number\n): Promise<ApiResponse<AdminPaymentDetail>> {\n  return fetchAPI<AdminPaymentDetail>(`/admin/finance/payments/${paymentId}`)\n}\n\n/**\n * Транзакции с фильтрами (status, method, start_date, end_date)\n */\nexport async function getAdminTransactions(\n  params?: TransactionQueryParams\n): Promise<ApiResponse<PaymentListResponse>> {\n  return fetchAPI<PaymentListResponse>(\n    withQuery('/admin/finance/transactions', params as Record<string, any>)\n  )\n}\n\n/**\n * Сводка по финансам (total_revenue, top_tariffs, recent_transactions_24h и т.д.)\n */\nexport async function getAdminFinanceSummary(): Promise<ApiResponse<AdminFinanceSummary>> {\n  return fetchAPI<AdminFinanceSummary>('/admin/finance/summary')\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 565, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Documents/programming/pixel-space-vpn/lib/api/internal.ts"],"sourcesContent":["/**\n * Internal API endpoints (superuser: Marzban sync, etc.)\n */\n\nimport { fetchAPI } from './client'\nimport type { ApiResponse } from '@/types/api'\n\nexport interface MarzbanSyncResponse {\n  total: number\n  synced: number\n  orphaned: number\n  errors: number\n  details?: Array<{\n    client_id: number\n    username: string\n    status: string\n    error?: string\n  }>\n}\n\n/**\n * Синхронизировать все VPN клиенты с Marzban (требуется superuser)\n */\nexport async function syncMarzban(): Promise<ApiResponse<MarzbanSyncResponse>> {\n  return fetchAPI<MarzbanSyncResponse>('/internal/marzban/sync', {\n    method: 'POST',\n  })\n}\n"],"names":[],"mappings":"AAAA;;CAEC;;;;AAED;;AAmBO,eAAe;IACpB,OAAO,IAAA,qLAAQ,EAAsB,0BAA0B;QAC7D,QAAQ;IACV;AACF"}},
    {"offset": {"line": 582, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Documents/programming/pixel-space-vpn/lib/api/health.ts"],"sourcesContent":["/**\n * Health & meta API endpoints\n */\n\nimport { fetchAPI } from './client'\nimport type { ApiResponse, HealthResponse, ApiInfoResponse } from '@/types/api'\n\nexport async function getHealthStatus(): Promise<ApiResponse<HealthResponse>> {\n  return fetchAPI<HealthResponse>('/health')\n}\n\nexport async function getApiInfo(): Promise<ApiResponse<ApiInfoResponse>> {\n  return fetchAPI<ApiInfoResponse>('/')\n}\n"],"names":[],"mappings":"AAAA;;CAEC;;;;;;AAED;;AAGO,eAAe;IACpB,OAAO,IAAA,qLAAQ,EAAiB;AAClC;AAEO,eAAe;IACpB,OAAO,IAAA,qLAAQ,EAAkB;AACnC"}},
    {"offset": {"line": 602, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Documents/programming/pixel-space-vpn/lib/api.ts"],"sourcesContent":["/**\n * API Client for SpaceVPN Backend\n *\n * Единая точка входа: реэкспорт из lib/api/* и types/api.\n * Базовый URL и fetch — в client.ts.\n */\n\n// Base URL (для Next.js routes и пр.)\nexport { API_BASE_URL, getAuthToken, setAuthToken, removeAuthToken, fetchAPI, withQuery } from './api/client'\n\n// Types — из единого источника\nexport type {\n  ApiResponse,\n  ApiError,\n  User,\n  TokenResponse,\n  OAuthProvider,\n  OAuthProvidersResponse,\n  GoogleAuthResponse,\n  TelegramAuthInfo,\n  TelegramAuthData,\n  SendVerificationCodeRequest,\n  VerifyCodeRequest,\n  VerifyEmailRequest,\n  ResetPasswordRequest,\n  Subscription,\n  MySubscriptionsResponse,\n  AdminSubscription,\n  PurchaseFreeTariffRequest,\n  PurchaseFreeTariffResponse,\n  ExtendPayload,\n  Plan,\n  ApplyPlanRequest,\n  Tariff,\n  PublicTariff,\n  PublicTariffsResponse,\n  VPNKeyStatus,\n  VPNKeyListResponse,\n  VPNClient,\n  VPNConfig,\n  ExtendKeyRequest,\n  ExtendKeyResponse,\n  CreateVPNClientPayload,\n  RegenerateVPNClientPayload,\n  UpdateVPNClientPayload,\n  BypassPreset,\n  BypassPresetsResponse,\n  HappDeeplinkResponse,\n  CreatePaymentRequest,\n  CreatePaymentResponse,\n  Payment,\n  KeySearchRequest,\n  KeySearchResult,\n  CreateKeyRequest,\n  CreateKeyResult,\n  RenewKeyRequest,\n  RenewKeyResult,\n  KeyByPaymentResponse,\n  AdminVPNClient,\n  AdminFinanceStats,\n  AdminFinanceChartData,\n  AdminFinanceSummary,\n  AdminPayment,\n  AdminPaymentDetail,\n  PaymentListResponse,\n  TransactionQueryParams,\n  AdminCreateSubscriptionPayload,\n  CreateTariffPayload,\n  UpdateTariffPayload,\n  UpdateProfilePayload,\n  PaginationParams,\n  PaymentQueryParams,\n  VPNStatus,\n  HealthResponse,\n  ApiInfoResponse,\n} from '@/types/api'\n\n// Auth\nexport {\n  registerUser,\n  loginUser,\n  logoutUser,\n  isAuthenticated,\n  getOAuthProviders,\n  getGoogleAuthUrl,\n  getTelegramAuthInfo,\n  telegramAuthCallback,\n  sendVerificationCode,\n  verifyCode,\n  verifyEmail,\n  resetPassword,\n} from './api/auth'\n\n// Users\nexport {\n  getCurrentUser,\n  getStoredUser,\n  setCurrentUser,\n  removeCurrentUser,\n  getCurrentUserInfo,\n  updateCurrentUser,\n  getUserVPNStatus,\n} from './api/users'\n\n// Subscriptions\nexport { getMySubscriptions, purchaseFreeTariff } from './api/subscriptions'\n\n// Tariffs\nexport { getPublicTariffs, getPublicTariffById } from './api/tariffs'\n\n// Plans\nexport { getPlans } from './api/plans'\n\n// Public API (без авторизации)\nexport {\n  getPublicTariffs as getPublicTariffsNoAuth,\n  searchKey as searchKeyPublic,\n  createKeyPublic,\n  renewKey as renewKeyPublic,\n  getKeyByPayment,\n  pollKeyByPayment,\n} from './api/public-api'\n\n// Payments\nexport {\n  createPayment,\n  getPaymentStatus,\n  initiatePayment,\n  createYookassaPayment,\n  confirmYookassaPayment,\n} from './api/payments'\nexport type {\n  CreateYookassaPaymentPayload,\n  CreateYookassaPaymentResponse,\n  ConfirmYookassaPaymentResponse,\n} from './api/payments'\n\n// VPN Keys & Clients\nexport {\n  getUserVPNKeys,\n  getVPNKeyStatus,\n  extendVPNKey,\n  getHappDeeplink,\n  getUserVPNClients,\n  getUserVPNClients as listUserVPNClients,\n  getUserVPNClient,\n  updateUserVPNClient,\n  deleteUserVPNClient,\n  getUserVPNClientConfig,\n  regenerateUserVPNClient,\n  syncUserVPNClient,\n  getBypassPresets,\n  createUserVPNClient,\n} from './api/vpn-keys'\n\n// Admin\nexport {\n  adminListUsers,\n  adminGetUser,\n  adminDeleteUser,\n  adminToggleUserActive,\n  adminMakeSuperuser,\n  adminApplyPlan,\n  adminListSubscriptions,\n  adminGetSubscription,\n  adminCreateSubscription,\n  adminDeleteSubscription,\n  adminExtendSubscription,\n  adminToggleSubscription,\n  adminListVPNClients,\n  adminGetVPNClient,\n  adminCreateVPNClient,\n  adminUpdateVPNClient,\n  adminDeleteVPNClient,\n  adminExtendVPNClient,\n  adminToggleVPNClient,\n  adminListTariffs,\n  adminCreateTariff,\n  adminUpdateTariff,\n  adminDeleteTariff,\n  adminToggleTariff,\n  getAdminFinanceStats,\n  getAdminFinanceChart,\n  getAdminPayments,\n  getAdminPaymentDetails,\n  getAdminTransactions,\n  getAdminFinanceSummary,\n} from './api/admin'\n\n// Internal (superuser)\nexport { syncMarzban } from './api/internal'\nexport type { MarzbanSyncResponse } from './api/internal'\n\n// Health\nexport { getHealthStatus, getApiInfo } from './api/health'\n"],"names":[],"mappings":"AAAA;;;;;CAKC,GAED,sCAAsC;;AACtC;AAqEA,OAAO;AACP;AAeA,QAAQ;AACR;AAUA,gBAAgB;AAChB;AAEA,UAAU;AACV;AAEA,QAAQ;AACR;AAEA,+BAA+B;AAC/B;AASA,WAAW;AACX;AAaA,qBAAqB;AACrB;AAiBA,QAAQ;AACR;AAiCA,uBAAuB;AACvB;AAGA,SAAS;AACT"}},
    {"offset": {"line": 648, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Documents/programming/pixel-space-vpn/app/login/page.tsx"],"sourcesContent":["\"use client\"\n\nimport type React from \"react\"\nimport { useState, useEffect } from \"react\"\nimport Link from \"next/link\"\nimport { useRouter } from \"next/navigation\"\nimport { Eye, EyeOff, Loader2 } from \"lucide-react\"\nimport { PixelStars } from \"@/components/pixel-stars\"\nimport { useAuth } from \"@/lib/auth-context\"\nimport { getGoogleAuthUrl, getTelegramAuthInfo, getOAuthProviders, type OAuthProvider } from \"@/lib/api\"\n\n// Telegram Login Widget script loader\ndeclare global {\n  interface Window {\n    TelegramLoginWidget: {\n      dataOnauth: (user: any) => void\n    }\n  }\n}\n\nexport default function LoginPage() {\n  const [showPassword, setShowPassword] = useState(false)\n  const [username, setUsername] = useState(\"\")\n  const [password, setPassword] = useState(\"\")\n  const [error, setError] = useState(\"\")\n  const [loading, setLoading] = useState(false)\n  const [oauthLoading, setOauthLoading] = useState<string | null>(null)\n  const [oauthProviders, setOauthProviders] = useState<OAuthProvider[]>([])\n  const { login } = useAuth()\n  const router = useRouter()\n\n  useEffect(() => {\n    // Load OAuth providers\n    loadOAuthProviders()\n  }, [])\n\n  const loadOAuthProviders = async () => {\n    const response = await getOAuthProviders()\n    if (response.data?.providers) {\n      setOauthProviders(response.data.providers)\n    }\n  }\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault()\n    setError(\"\")\n    setLoading(true)\n\n    try {\n      const result = await login(username, password)\n      if (result.success) {\n        router.push(\"/account\")\n      } else {\n        setError(result.error || \"Ошибка входа\")\n      }\n    } catch (err) {\n      setError(\"Ошибка сети. Проверьте подключение к интернету.\")\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const handleGoogleLogin = async () => {\n    setOauthLoading(\"google\")\n    setError(\"\")\n\n    try {\n      const response = await getGoogleAuthUrl()\n      if (response.data?.auth_url) {\n        // Save state for verification\n        sessionStorage.setItem(\"oauth_state\", response.data.state)\n        // Redirect to Google\n        window.location.href = response.data.auth_url\n      } else {\n        setError(response.error || \"Google авторизация недоступна\")\n      }\n    } catch (err) {\n      setError(\"Не удалось подключиться к Google\")\n    } finally {\n      setOauthLoading(null)\n    }\n  }\n\n  const handleTelegramLogin = async () => {\n    setOauthLoading(\"telegram\")\n    setError(\"\")\n\n    try {\n      const response = await getTelegramAuthInfo()\n      if (response.data?.bot_username) {\n        // Open Telegram login in popup\n        const botUsername = response.data.bot_username\n        const redirectUrl = encodeURIComponent(window.location.origin + \"/auth/telegram/callback\")\n        const telegramUrl = `https://oauth.telegram.org/auth?bot_id=${botUsername}&origin=${window.location.origin}&request_access=write&return_to=${redirectUrl}`\n\n        // Open popup\n        const width = 550\n        const height = 470\n        const left = window.screenX + (window.outerWidth - width) / 2\n        const top = window.screenY + (window.outerHeight - height) / 2\n\n        window.open(\n          telegramUrl,\n          \"telegram_auth\",\n          `width=${width},height=${height},left=${left},top=${top}`\n        )\n      } else {\n        setError(response.error || \"Telegram авторизация недоступна\")\n      }\n    } catch (err) {\n      setError(\"Не удалось подключиться к Telegram\")\n    } finally {\n      setOauthLoading(null)\n    }\n  }\n\n  const googleEnabled = oauthProviders.some(p => p.id === \"google\" && p.enabled)\n  const telegramEnabled = oauthProviders.some(p => p.id === \"telegram\" && p.enabled)\n\n  return (\n    <div className=\"min-h-screen bg-background relative flex items-center justify-center px-3 sm:px-4 py-6 sm:py-8\">\n      <PixelStars />\n\n      {/* Back to home */}\n      <Link href=\"/\" className=\"absolute top-3 left-3 sm:top-4 sm:left-4 text-muted-foreground hover:text-primary text-[9px] sm:text-[10px] z-20\">\n        ← Назад\n      </Link>\n\n      <div className=\"w-full max-w-md relative z-10\">\n        {/* Logo */}\n        <div className=\"text-center mb-6 sm:mb-8\">\n          <div className=\"flex items-center justify-center gap-2 mb-3 sm:mb-4\">\n            <div className=\"w-8 h-8 sm:w-10 sm:h-10 bg-primary flex items-center justify-center\">\n              <span className=\"text-background text-xs sm:text-sm\">S</span>\n            </div>\n          </div>\n          <h1 className=\"text-foreground text-xs sm:text-sm\">SPACE VPN</h1>\n        </div>\n\n        {/* Error message */}\n        {error && (\n          <div className=\"mb-3 sm:mb-4 p-2.5 sm:p-3 bg-red-500/10 border border-red-500/50 text-red-500 text-[9px] sm:text-[10px]\">\n            {error}\n          </div>\n        )}\n\n        {/* Social Login */}\n        <div className=\"flex gap-2 sm:gap-4 mb-4 sm:mb-6\">\n          <button\n            onClick={handleGoogleLogin}\n            disabled={oauthLoading !== null || !googleEnabled}\n            className=\"flex-1 bg-card border border-border py-2.5 sm:py-3 flex items-center justify-center gap-1.5 sm:gap-2 hover:border-primary transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\n          >\n            {oauthLoading === \"google\" ? (\n              <Loader2 className=\"w-4 h-4 sm:w-5 sm:h-5 animate-spin\" />\n            ) : (\n              <svg className=\"w-4 h-4 sm:w-5 sm:h-5\" viewBox=\"0 0 24 24\">\n                <path\n                  fill=\"#4285F4\"\n                  d=\"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z\"\n                />\n                <path\n                  fill=\"#34A853\"\n                  d=\"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z\"\n                />\n                <path\n                  fill=\"#FBBC05\"\n                  d=\"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z\"\n                />\n                <path\n                  fill=\"#EA4335\"\n                  d=\"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z\"\n                />\n              </svg>\n            )}\n            <span className=\"text-foreground text-[9px] sm:text-[10px]\">Google</span>\n          </button>\n          <button\n            onClick={handleTelegramLogin}\n            disabled={oauthLoading !== null || !telegramEnabled}\n            className=\"flex-1 bg-card border border-border py-2.5 sm:py-3 flex items-center justify-center gap-1.5 sm:gap-2 hover:border-primary transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\n          >\n            {oauthLoading === \"telegram\" ? (\n              <Loader2 className=\"w-4 h-4 sm:w-5 sm:h-5 animate-spin\" />\n            ) : (\n              <svg className=\"w-4 h-4 sm:w-5 sm:h-5\" viewBox=\"0 0 24 24\" fill=\"#0088cc\">\n                <path d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm4.64 6.8c-.15 1.58-.8 5.42-1.13 7.19-.14.75-.42 1-.68 1.03-.58.05-1.02-.38-1.58-.75-.88-.58-1.38-.94-2.23-1.5-.99-.65-.35-1.01.22-1.59.15-.15 2.71-2.48 2.76-2.69.01-.03.01-.14-.07-.2-.08-.06-.19-.04-.27-.02-.12.02-1.96 1.25-5.54 3.69-.52.36-1 .53-1.42.52-.47-.01-1.37-.26-2.03-.48-.82-.27-1.47-.42-1.42-.88.03-.24.37-.49 1.02-.74 3.98-1.73 6.64-2.87 7.97-3.43 3.79-1.6 4.58-1.88 5.1-1.89.11 0 .37.03.54.17.14.12.18.28.2.45-.01.06.01.24 0 .38z\" />\n              </svg>\n            )}\n            <span className=\"text-foreground text-[9px] sm:text-[10px]\">Telegram</span>\n          </button>\n        </div>\n\n        {/* Login Form */}\n        <form onSubmit={handleSubmit} className=\"space-y-3 sm:space-y-4\">\n          <div>\n            <label className=\"block text-foreground text-[9px] sm:text-[10px] mb-1.5 sm:mb-2\">Логин или E-mail</label>\n            <input\n              type=\"text\"\n              value={username}\n              onChange={(e) => setUsername(e.target.value)}\n              placeholder=\"Введите логин или email\"\n              required\n              disabled={loading}\n              className=\"w-full bg-card border border-border px-3 sm:px-4 py-2.5 sm:py-3 text-foreground text-[9px] sm:text-[10px] placeholder:text-muted-foreground focus:outline-none focus:border-primary disabled:opacity-50\"\n            />\n          </div>\n\n          <div>\n            <div className=\"flex items-center justify-between mb-1.5 sm:mb-2\">\n              <label className=\"text-foreground text-[9px] sm:text-[10px]\">Пароль</label>\n              <Link href=\"/forgot-password\" className=\"text-muted-foreground hover:text-primary text-[9px] sm:text-[10px]\">\n                Забыли?\n              </Link>\n            </div>\n            <div className=\"relative\">\n              <input\n                type={showPassword ? \"text\" : \"password\"}\n                value={password}\n                onChange={(e) => setPassword(e.target.value)}\n                placeholder=\"Введите пароль\"\n                required\n                disabled={loading}\n                className=\"w-full bg-card border border-border px-3 sm:px-4 py-2.5 sm:py-3 text-foreground text-[9px] sm:text-[10px] placeholder:text-muted-foreground focus:outline-none focus:border-primary pr-10 sm:pr-12 disabled:opacity-50\"\n              />\n              <button\n                type=\"button\"\n                onClick={() => setShowPassword(!showPassword)}\n                className=\"absolute right-3 sm:right-4 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground\"\n                disabled={loading}\n              >\n                {showPassword ? <EyeOff size={16} className=\"sm:w-[18px] sm:h-[18px]\" /> : <Eye size={16} className=\"sm:w-[18px] sm:h-[18px]\" />}\n              </button>\n            </div>\n          </div>\n\n          <button\n            type=\"submit\"\n            disabled={loading}\n            className=\"w-full bg-primary text-primary-foreground py-2.5 sm:py-3 text-[9px] sm:text-[10px] hover:bg-primary/80 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2\"\n          >\n            {loading ? (\n              <>\n                <Loader2 className=\"w-3.5 h-3.5 sm:w-4 sm:h-4 animate-spin\" />\n                Вход...\n              </>\n            ) : (\n              \"Войти\"\n            )}\n          </button>\n        </form>\n\n        <Link\n          href=\"/register\"\n          className=\"block w-full mt-3 sm:mt-4 bg-card border border-border py-2.5 sm:py-3 text-center text-foreground text-[9px] sm:text-[10px] hover:border-primary transition-colors\"\n        >\n          Создать аккаунт\n        </Link>\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}}]
}