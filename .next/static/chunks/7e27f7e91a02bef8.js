(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,25121,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"warnOnce",{enumerable:!0,get:function(){return n}});let n=e=>{}},49051,e=>{"use strict";let t="/api/v1";function r(){return localStorage.getItem("auth_token")}function n(){let e=localStorage.getItem("current_user");return e?JSON.parse(e):null}async function i(e,n={}){let a=r(),s="undefined"!=typeof FormData&&n.body instanceof FormData,o=new Headers(n.headers||{});o.has("Accept")||o.set("Accept","application/json");let u=void 0!==n.body&&null!==n.body&&""!==n.body;s||!u||o.has("Content-Type")||o.set("Content-Type","application/json"),a&&!o.has("Authorization")&&o.set("Authorization",`Bearer ${a}`);try{let r=await fetch(function(e){let r=t.endsWith("/")?t.slice(0,-1):t;if(!e||"/"===e)return`${r}/`;let n=e.startsWith("/")?e:`/${e}`;return`${r}${n}`}(e),{...n,headers:o}),i=r.status,a=await r.text(),s=a?function(e){try{return JSON.parse(e)}catch{return e}}(a):void 0;if(!r.ok){if(422===i&&Array.isArray(s?.detail))return{error:s.detail.map(e=>`${e.loc?.join(" → ")||"Field"}: ${e.msg}`).join(", "),status:i};let e=s?.detail||s?.message||(Array.isArray(s?.errors)?s?.errors.join(", "):void 0);return{error:"string"==typeof e?e:`HTTP ${i}`,status:i}}return{data:s,status:i}}catch(e){return{error:e instanceof Error?e.message:"Network error"}}}async function a(e,t,r,n){return i("/auth/register",{method:"POST",body:JSON.stringify({username:e,email:t,password:r,full_name:n})})}async function s(e,t){var r;let n=new URLSearchParams;n.append("username",e),n.append("password",t);let a=await i("/auth/login",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:n.toString()});return a.data?.access_token&&(r=a.data.access_token,localStorage.setItem("auth_token",r)),a}function o(){localStorage.removeItem("auth_token"),localStorage.removeItem("current_user")}function u(){return null!==r()}async function c(){var e;let t=await i("/users/me");return t.data&&(e=t.data,localStorage.setItem("current_user",JSON.stringify(e))),t}async function l(){return i("/users/me/vpn")}async function d(e){return i(function(e,t){if(!t)return e;let r=new URLSearchParams;Object.entries(t).forEach(([e,t])=>{null!=t&&r.append(e,String(t))});let n=r.toString();return n?`${e}?${n}`:e}("/admin/users/",e))}async function f(){return i("/subscriptions/")}async function y(){return i("/admin/subscriptions/")}async function m(){return i("/tariffs/")}async function g(){return i("/admin/tariffs/")}async function h(e){return i("/admin/tariffs/",{method:"POST",body:JSON.stringify(e)})}async function p(e,t){return i(`/admin/tariffs/${e}`,{method:"PATCH",body:JSON.stringify(t)})}async function S(e){return i(`/admin/tariffs/${e}`,{method:"DELETE"})}async function P(e){return i(`/admin/tariffs/${e}/toggle`,{method:"POST"})}async function v(e){return i("/subscriptions/purchase-free",{method:"POST",body:JSON.stringify(e)})}async function T(e){return i("/vpn-clients/",{method:"POST",body:JSON.stringify(e)})}async function b(){return i("/vpn-clients/")}async function O(e){return i(`/vpn-clients/${e}/config`)}async function U(e,t){return i(`/vpn-clients/${e}/regenerate`,{method:"POST",body:t?JSON.stringify(t):void 0})}async function C(e){return i(`/vpn-clients/${e}/sync`,{method:"POST"})}async function N(){return i("/admin/vpn/clients/")}async function w(e){return i("/admin/vpn/clients/",{method:"POST",body:JSON.stringify(e)})}async function A(e,t){return i(`/admin/vpn/clients/${e}`,{method:"PUT",body:JSON.stringify(t)})}async function $(e){return i(`/admin/vpn/clients/${e}`,{method:"DELETE"})}async function j(e,t){return i(`/admin/vpn/clients/${e}/extend`,{method:"POST",body:t?JSON.stringify(t):void 0})}e.s(["adminCreateTariff",()=>h,"adminCreateVPNClient",()=>w,"adminDeleteTariff",()=>S,"adminDeleteVPNClient",()=>$,"adminExtendVPNClient",()=>j,"adminListSubscriptions",()=>y,"adminListTariffs",()=>g,"adminListUsers",()=>d,"adminListVPNClients",()=>N,"adminToggleTariff",()=>P,"adminUpdateTariff",()=>p,"adminUpdateVPNClient",()=>A,"createUserVPNClient",()=>T,"getCurrentUser",()=>n,"getCurrentUserInfo",()=>c,"getPublicTariffs",()=>m,"getUserSubscriptions",()=>f,"getUserVPNClientConfig",()=>O,"getUserVPNStatus",()=>l,"isAuthenticated",()=>u,"listUserVPNClients",()=>b,"loginUser",()=>s,"logoutUser",()=>o,"purchaseFreeTariff",()=>v,"regenerateUserVPNClient",()=>U,"registerUser",()=>a,"syncUserVPNClient",()=>C])},84654,(e,t,r)=>{t.exports=e.r(61938)},96636,e=>{"use strict";var t=e.i(3422),r=e.i(20278),n=e.i(84654),i=e.i(49051);let a=(0,r.createContext)(void 0);function s({children:e}){let[s,o]=(0,r.useState)(null),[u,c]=(0,r.useState)(!0),l=(0,n.useRouter)();(0,r.useEffect)(()=>{(async()=>{if((0,i.isAuthenticated)()){let e=(0,i.getCurrentUser)();e&&o(e);let t=await (0,i.getCurrentUserInfo)();t.data?o(t.data):t.error&&((0,i.logoutUser)(),o(null))}c(!1)})()},[]);let d=async(e,t)=>{c(!0);try{let r=await (0,i.loginUser)(e,t);if(r.data){let e=await (0,i.getCurrentUserInfo)();if(e.data)return o(e.data),c(!1),{success:!0}}return c(!1),{success:!1,error:r.error||"Login failed"}}catch(e){return c(!1),{success:!1,error:e instanceof Error?e.message:"Login failed"}}},f=async(e,t,r,n)=>{c(!0);try{let a=await (0,i.registerUser)(e,t,r,n);if(a.data)return await d(e,r);return c(!1),{success:!1,error:a.error||"Registration failed"}}catch(e){return c(!1),{success:!1,error:e instanceof Error?e.message:"Registration failed"}}},y=async()=>{if((0,i.isAuthenticated)()){let e=await (0,i.getCurrentUserInfo)();e.data&&o(e.data)}};return(0,t.jsx)(a.Provider,{value:{user:s,loading:u,login:d,logout:()=>{(0,i.logoutUser)(),o(null),l.push("/login")},register:f,refreshUser:y},children:e})}function o(){let e=(0,r.useContext)(a);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}function u(e){return function(i){let{user:a,loading:s}=o(),u=(0,n.useRouter)();return((0,r.useEffect)(()=>{s||a||u.push("/login")},[a,s,u]),s)?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsx)("div",{className:"text-muted-foreground",children:"Загрузка..."})}):a?(0,t.jsx)(e,{...i}):null}}e.s(["AuthProvider",()=>s,"useAuth",()=>o,"withAuth",()=>u])}]);