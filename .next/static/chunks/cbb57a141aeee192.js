(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,67913,(e,t,r)=>{t.exports=e.r(1247)},11500,e=>{"use strict";var t=e.i(2944),r=e.i(92539),n=e.i(67913),a=e.i(22154);let i=(0,r.createContext)(void 0);function o({children:e}){let[o,s]=(0,r.useState)(null),[c,u]=(0,r.useState)(!0),l=(0,n.useRouter)();(0,r.useEffect)(()=>{(async()=>{if((0,a.isAuthenticated)()){let e=(0,a.getCurrentUser)();e&&s(e);let t=await (0,a.getCurrentUserInfo)();t.data?s(t.data):t.error&&((0,a.logoutUser)(),s(null))}u(!1)})()},[]);let d=async(e,t)=>{u(!0);try{let r=await (0,a.loginUser)(e,t);if(r.data){let e=await (0,a.getCurrentUserInfo)();if(e.data)return s(e.data),u(!1),{success:!0}}return u(!1),{success:!1,error:r.error||"Login failed"}}catch(e){return u(!1),{success:!1,error:e instanceof Error?e.message:"Login failed"}}},f=async(e,t,r,n)=>{u(!0);try{let i=await (0,a.registerUser)(e,t,r,n);if(i.data)return await d(e,r);return u(!1),{success:!1,error:i.error||"Registration failed"}}catch(e){return u(!1),{success:!1,error:e instanceof Error?e.message:"Registration failed"}}},m=async()=>{if((0,a.isAuthenticated)()){let e=await (0,a.getCurrentUserInfo)();e.data&&s(e.data)}};return(0,t.jsx)(i.Provider,{value:{user:o,loading:c,login:d,logout:()=>{(0,a.logoutUser)(),s(null),l.push("/login")},register:f,refreshUser:m},children:e})}function s(){let e=(0,r.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}function c(e){return function(a){let{user:i,loading:o}=s(),c=(0,n.useRouter)();return((0,r.useEffect)(()=>{o||i||c.push("/login")},[i,o,c]),o)?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsx)("div",{className:"text-muted-foreground",children:"Загрузка..."})}):i?(0,t.jsx)(e,{...a}):null}}e.s(["AuthProvider",()=>o,"useAuth",()=>s,"withAuth",()=>c])},69117,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"warnOnce",{enumerable:!0,get:function(){return n}});let n=e=>{}},22154,e=>{"use strict";let t="/api/v1";function r(){return localStorage.getItem("auth_token")}function n(){let e=localStorage.getItem("current_user");return e?JSON.parse(e):null}async function a(e,n={}){let i=r(),o="undefined"!=typeof FormData&&n.body instanceof FormData,s=new Headers(n.headers||{});s.has("Accept")||s.set("Accept","application/json");let c=void 0!==n.body&&null!==n.body&&""!==n.body;o||!c||s.has("Content-Type")||s.set("Content-Type","application/json"),i&&!s.has("Authorization")&&s.set("Authorization",`Bearer ${i}`);try{let r=await fetch(function(e){let r=t.endsWith("/")?t.slice(0,-1):t;if(!e||"/"===e)return`${r}/`;let n=e.startsWith("/")?e:`/${e}`;return`${r}${n}`}(e),{...n,headers:s}),a=r.status,i=await r.text(),o=i?function(e){try{return JSON.parse(e)}catch{return e}}(i):void 0;if(!r.ok){if(422===a&&Array.isArray(o?.detail))return{error:o.detail.map(e=>`${e.loc?.join(" → ")||"Field"}: ${e.msg}`).join(", "),status:a};let e=o?.detail||o?.message||(Array.isArray(o?.errors)?o?.errors.join(", "):void 0);return{error:"string"==typeof e?e:`HTTP ${a}`,status:a}}return{data:o,status:a}}catch(e){return{error:e instanceof Error?e.message:"Network error"}}}async function i(e,t,r,n){return a("/auth/register",{method:"POST",body:JSON.stringify({username:e,email:t,password:r,full_name:n})})}async function o(e,t){var r;let n=new URLSearchParams;n.append("username",e),n.append("password",t);let i=await a("/auth/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:n.toString()});return i.data?.access_token&&(r=i.data.access_token,localStorage.setItem("auth_token",r)),i}function s(){localStorage.removeItem("auth_token"),localStorage.removeItem("current_user")}function c(){return null!==r()}async function u(){var e;let t=await a("/users/me");return t.data&&(e=t.data,localStorage.setItem("current_user",JSON.stringify(e))),t}async function l(e){return a(function(e,t){if(!t)return e;let r=new URLSearchParams;Object.entries(t).forEach(([e,t])=>{null!=t&&r.append(e,String(t))});let n=r.toString();return n?`${e}?${n}`:e}("/admin/users",e))}async function d(){return a("/subscriptions")}async function f(){return a("/admin/subscriptions")}async function m(){return a("/tariffs")}async function y(){return a("/admin/tariffs")}async function p(e){return a("/admin/tariffs",{method:"POST",body:JSON.stringify(e)})}async function h(e,t){return a(`/admin/tariffs/${e}`,{method:"PATCH",body:JSON.stringify(t)})}async function g(e){return a(`/admin/tariffs/${e}`,{method:"DELETE"})}async function w(e){return a(`/admin/tariffs/${e}/toggle`,{method:"POST"})}async function v(){return a("/vpn-clients")}async function S(e){return a("/vpn-clients",{method:"POST",body:e?JSON.stringify(e):void 0})}async function b(e){return a(`/vpn-clients/${e}/config`)}async function P(e){return a(`/vpn-clients/${e}/regenerate`,{method:"POST"})}async function T(e){return a(`/vpn-clients/${e}/sync`,{method:"POST"})}async function $(){return a("/admin/vpn/clients")}async function A(e){return a("/admin/vpn/clients",{method:"POST",body:JSON.stringify(e)})}async function O(e,t){return a(`/admin/vpn/clients/${e}`,{method:"PUT",body:JSON.stringify(t)})}async function k(e){return a(`/admin/vpn/clients/${e}`,{method:"DELETE"})}async function C(e,t){return a(`/admin/vpn/clients/${e}/extend`,{method:"POST",body:t?JSON.stringify(t):void 0})}async function N(e){let t=r();if(!t)return{error:"Требуется авторизация для оплаты"};try{let r=await fetch("/api/yookassa/create-payment",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify(e)}),n=await r.json().catch(()=>({}));if(!r.ok)return{error:n?.error||n?.message||`HTTP ${r.status}`};return{data:n}}catch(e){return{error:e instanceof Error?e.message:"Network error"}}}async function U(e){let t=r();if(!t)return{error:"Требуется авторизация для оплаты"};try{let r=await fetch("/api/yookassa/confirm-payment",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({paymentId:e})}),n=await r.json().catch(()=>({}));if(!r.ok)return{error:n?.error||n?.message||`HTTP ${r.status}`};return{data:n}}catch(e){return{error:e instanceof Error?e.message:"Network error"}}}e.s(["adminCreateTariff",()=>p,"adminCreateVPNClient",()=>A,"adminDeleteTariff",()=>g,"adminDeleteVPNClient",()=>k,"adminExtendVPNClient",()=>C,"adminListSubscriptions",()=>f,"adminListTariffs",()=>y,"adminListUsers",()=>l,"adminListVPNClients",()=>$,"adminToggleTariff",()=>w,"adminUpdateTariff",()=>h,"adminUpdateVPNClient",()=>O,"confirmYookassaPayment",()=>U,"createUserVPNClient",()=>S,"createYookassaPayment",()=>N,"getCurrentUser",()=>n,"getCurrentUserInfo",()=>u,"getPublicTariffs",()=>m,"getUserSubscriptions",()=>d,"getUserVPNClientConfig",()=>b,"isAuthenticated",()=>c,"listUserVPNClients",()=>v,"loginUser",()=>o,"logoutUser",()=>s,"regenerateUserVPNClient",()=>P,"registerUser",()=>i,"syncUserVPNClient",()=>T])},32372,e=>{"use strict";var t=e.i(92539),r=e.i(67913);function n(){return"undefined"!=typeof window}function a(){return"production"}function i(){return"development"===((n()?window.vam:a())||"production")}function o(e){return RegExp(`/${e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}(?=[/?#]|$)`)}function s(e){return(0,t.useEffect)(()=>{!function(e={debug:!0}){var t;if(!n())return;!function(e="auto"){if("auto"===e){window.vam=a();return}window.vam=e}(e.mode),window.va||(window.va=function(...e){(window.vaq=window.vaq||[]).push(e)}),e.beforeSend&&(null==(t=window.va)||t.call(window,"beforeSend",e.beforeSend));let r=e.scriptSrc||(i()?"https://va.vercel-scripts.com/v1/script.debug.js":"/_vercel/insights/script.js");if(document.head.querySelector(`script[src*="${r}"]`))return;let o=document.createElement("script");o.src=r,o.defer=!0,o.dataset.sdkn="@vercel/analytics"+(e.framework?`/${e.framework}`:""),o.dataset.sdkv="1.3.1",e.disableAutoTrack&&(o.dataset.disableAutoTrack="1"),e.endpoint&&(o.dataset.endpoint=e.endpoint),e.dsn&&(o.dataset.dsn=e.dsn),o.onerror=()=>{let e=i()?"Please check if any ad blockers are enabled and try again.":"Be sure to enable Web Analytics for your project and deploy again. See https://vercel.com/docs/analytics/quickstart for more information.";console.log(`[Vercel Web Analytics] Failed to load script from ${r}. ${e}`)},i()&&!1===e.debug&&(o.dataset.debug="false"),document.head.appendChild(o)}({framework:e.framework||"react",...void 0!==e.route&&{disableAutoTrack:!0},...e})},[]),(0,t.useEffect)(()=>{e.route&&e.path&&function({route:e,path:t}){var r;null==(r=window.va)||r.call(window,"pageview",{route:e,path:t})}({route:e.route,path:e.path})},[e.route,e.path]),null}function c(e){let n,a,i,c,{route:u,path:l}=(n=(0,r.useParams)(),a=(0,r.useSearchParams)(),i=(0,r.usePathname)(),c={...Object.fromEntries(a.entries()),...n||{}},{route:n?function(e,t){if(!e||!t)return e;let r=e;try{let e=Object.entries(t);for(let[t,n]of e)if(!Array.isArray(n)){let e=o(n);e.test(r)&&(r=r.replace(e,`/[${t}]`))}for(let[t,n]of e)if(Array.isArray(n)){let e=o(n.join("/"));e.test(r)&&(r=r.replace(e,`/[...${t}]`))}return r}catch(t){return e}}(i,c):null,path:i});return t.default.createElement(s,{path:l,route:u,...e,framework:"next"})}function u(e){return t.default.createElement(t.Suspense,{fallback:null},t.default.createElement(c,{...e}))}e.s(["Analytics",()=>u])}]);