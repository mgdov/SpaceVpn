(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,95026,e=>{"use strict";var t=e.i(20278);let r=(...e)=>e.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim();var n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let a=(0,t.forwardRef)(({color:e="currentColor",size:a=24,strokeWidth:s=2,absoluteStrokeWidth:i,className:c="",children:o,iconNode:l,...u},d)=>(0,t.createElement)("svg",{ref:d,...n,width:a,height:a,stroke:e,strokeWidth:i?24*Number(s)/Number(a):s,className:r("lucide",c),...u},[...l.map(([e,r])=>(0,t.createElement)(e,r)),...Array.isArray(o)?o:[o]])),s=(e,n)=>{let s=(0,t.forwardRef)(({className:s,...i},c)=>(0,t.createElement)(a,{ref:c,iconNode:n,className:r(`lucide-${e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,s),...i}));return s.displayName=`${e}`,s};e.s(["default",()=>s],95026)},99866,e=>{"use strict";var t=e.i(19212),r=e.i(20278);function n(){let[e,n]=(0,r.useState)([]);return(0,r.useEffect)(()=>{let e=[];for(let t=0;t<100;t++)e.push({id:t,x:100*Math.random(),y:100*Math.random(),size:Math.random()>.8?2:1,delay:3*Math.random(),type:Math.random()>.7?"cross":"dot"});n(e)},[]),(0,t.jsx)("div",{className:"fixed inset-0 overflow-hidden pointer-events-none z-0",children:e.map(e=>(0,t.jsx)("div",{className:"absolute star",style:{left:`${e.x}%`,top:`${e.y}%`,animationDelay:`${e.delay}s`},children:"cross"===e.type?(0,t.jsx)("div",{className:"text-blue-300 text-opacity-60",style:{fontSize:`${6*e.size}px`},children:"+"}):(0,t.jsx)("div",{className:"bg-cyan-300 rounded-none",style:{width:`${2*e.size}px`,height:`${2*e.size}px`}})},e.id))})}e.s(["PixelStars",()=>n])},49051,e=>{"use strict";let t="/api/v1";function r(e,t){if(!t)return e;let r=new URLSearchParams;Object.entries(t).forEach(([e,t])=>{null!=t&&r.append(e,String(t))});let n=r.toString();return n?`${e}?${n}`:e}function n(){return localStorage.getItem("auth_token")}function a(e){localStorage.setItem("auth_token",e)}function s(e){localStorage.setItem("current_user",JSON.stringify(e))}async function i(e,r={}){let a=n(),s="undefined"!=typeof FormData&&r.body instanceof FormData,c=new Headers(r.headers||{});c.has("Accept")||c.set("Accept","application/json");let o=void 0!==r.body&&null!==r.body&&""!==r.body;s||!o||c.has("Content-Type")||c.set("Content-Type","application/json"),a&&!c.has("Authorization")&&c.set("Authorization",`Bearer ${a}`);try{let n=await fetch(function(e){let r=t.endsWith("/")?t.slice(0,-1):t;if(!e||"/"===e)return`${r}/`;let n=e.startsWith("/")?e:`/${e}`;return`${r}${n}`}(e),{...r,headers:c}),a=n.status,s=await n.text(),i=s?function(e){try{return JSON.parse(e)}catch{return e}}(s):void 0;if(!n.ok){if(422===a&&Array.isArray(i?.detail))return{error:i.detail.map(e=>`${e.loc?.join(" → ")||"Field"}: ${e.msg}`).join(", "),status:a};let e=i?.detail||i?.message||(Array.isArray(i?.errors)?i?.errors.join(", "):void 0);return{error:"string"==typeof e?e:`HTTP ${a}`,status:a}}return{data:i,status:a}}catch(e){return{error:e instanceof Error?e.message:"Network error"}}}async function c(e,t){let r=new URLSearchParams;r.append("username",e),r.append("password",t);let n=await i("/auth/login",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:r.toString()});return n.data?.access_token&&a(n.data.access_token),n}async function o(){return i("/auth/oauth-providers")}async function l(){return i("/auth/google")}async function u(){return i("/auth/telegram")}async function d(e){let t=await i("/auth/telegram/callback",{method:"POST",body:JSON.stringify(e)});return t.data?.access_token&&a(t.data.access_token),t}async function m(){let e=await i("/users/me");return e.data&&s(e.data),e}async function f(e){return i(r("/admin/users/",e))}async function h(){return i("/admin/subscriptions/")}async function y(){return i("/tariffs/")}async function p(){return i("/admin/tariffs/")}async function g(e){return i("/admin/tariffs/",{method:"POST",body:JSON.stringify(e)})}async function x(e,t){return i(`/admin/tariffs/${e}`,{method:"PATCH",body:JSON.stringify(t)})}async function N(e){return i(`/admin/tariffs/${e}`,{method:"DELETE"})}async function b(e){return i(`/admin/tariffs/${e}/toggle`,{method:"POST"})}async function v(e){return i("/subscriptions/purchase-free",{method:"POST",body:JSON.stringify(e)})}async function S(){return i("/vpn-clients")}async function j(e){return i(`/vpn-clients/${e}/config`)}async function T(){return i("/vpn-clients/bypass-presets")}async function k(){return i("/admin/vpn/clients/")}async function P(e){return i("/admin/vpn/clients/",{method:"POST",body:JSON.stringify(e)})}async function w(e,t){return i(`/admin/vpn/clients/${e}`,{method:"PUT",body:JSON.stringify(t)})}async function C(e){return i(`/admin/vpn/clients/${e}`,{method:"DELETE"})}async function $(e,t){return i(`/admin/vpn/clients/${e}/extend`,{method:"POST",body:t?JSON.stringify(t):void 0})}async function O(e){return i(`/admin/vpn/clients/${e}/toggle`,{method:"POST"})}async function A(){return i("/public/tariffs")}async function _(e){return i("/public/key/search",{method:"POST",body:JSON.stringify({key_identifier:e})})}async function z(e){return i("/public/key/create",{method:"POST",body:JSON.stringify(e)})}async function U(e){return i("/public/key/renew",{method:"POST",body:JSON.stringify(e)})}async function E(e){let t=n();if(!t)return{error:"Требуется авторизация для оплаты"};try{let r=await fetch("/api/yookassa/create-payment",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify(e)}),n=await r.json().catch(()=>({}));if(!r.ok)return{error:n?.error||n?.message||`HTTP ${r.status}`};return{data:n}}catch(e){return{error:e instanceof Error?e.message:"Network error"}}}async function L(){return i("/admin/finance/stats")}async function J(e){return i(`/admin/finance/chart/${e}`)}async function I(e){return i(r("/admin/finance/payments",e))}e.s(["adminCreateTariff",()=>g,"adminCreateVPNClient",()=>P,"adminDeleteTariff",()=>N,"adminDeleteVPNClient",()=>C,"adminExtendVPNClient",()=>$,"adminListSubscriptions",()=>h,"adminListTariffs",()=>p,"adminListUsers",()=>f,"adminListVPNClients",()=>k,"adminToggleTariff",()=>b,"adminToggleVPNClient",()=>O,"adminUpdateTariff",()=>x,"adminUpdateVPNClient",()=>w,"createKeyPublic",()=>z,"createYookassaPayment",()=>E,"getAdminFinanceChart",()=>J,"getAdminFinanceStats",()=>L,"getAdminPayments",()=>I,"getBypassPresets",()=>T,"getCurrentUserInfo",()=>m,"getGoogleAuthUrl",()=>l,"getOAuthProviders",()=>o,"getPublicTariffs",()=>y,"getPublicTariffsNoAuth",()=>A,"getTelegramAuthInfo",()=>u,"getUserVPNClientConfig",()=>j,"listUserVPNClients",()=>S,"loginUser",()=>c,"purchaseFreeTariff",()=>v,"renewKeyPublic",()=>U,"searchKeyPublic",()=>_,"setAuthToken",()=>a,"setCurrentUser",()=>s,"telegramAuthCallback",()=>d])},51871,e=>{"use strict";let t=(0,e.i(95026).default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>t],51871)},25149,e=>{"use strict";let t=(0,e.i(95026).default)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);e.s(["CheckCircle2",()=>t],25149)},20201,e=>{"use strict";let t=(0,e.i(95026).default)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);e.s(["XCircle",()=>t],20201)},35557,e=>{"use strict";var t=e.i(19212),r=e.i(20278),n=e.i(84654),a=e.i(51871),s=e.i(25149),i=e.i(20201),c=e.i(99866),o=e.i(49051);function l(){let e=(0,n.useRouter)(),l=(0,n.useSearchParams)(),[u,d]=(0,r.useState)("loading"),[m,f]=(0,r.useState)("");(0,r.useEffect)(()=>{h()},[]);let h=async()=>{let t=l.get("id"),r=l.get("first_name"),n=l.get("last_name"),a=l.get("username"),s=l.get("photo_url"),i=l.get("auth_date"),c=l.get("hash");if(!t||!c||!i){d("error"),f("Данные авторизации Telegram не найдены");return}try{let l=await (0,o.telegramAuthCallback)({id:parseInt(t),first_name:r||"",last_name:n||void 0,username:a||void 0,photo_url:s||void 0,auth_date:parseInt(i),hash:c});if(l.data?.access_token){let t=await (0,o.getCurrentUserInfo)();t.data&&(0,o.setCurrentUser)(t.data),d("success"),setTimeout(()=>{e.push("/account")},1500)}else d("error"),f(l.error||"Ошибка авторизации через Telegram")}catch(e){d("error"),f("Ошибка подключения")}};return(0,t.jsxs)("div",{className:"min-h-screen bg-background relative flex items-center justify-center px-4",children:[(0,t.jsx)(c.PixelStars,{}),(0,t.jsxs)("div",{className:"w-full max-w-md relative z-10 text-center",children:[(0,t.jsx)("div",{className:"flex items-center justify-center gap-2 mb-8",children:(0,t.jsx)("div",{className:"w-10 h-10 bg-primary flex items-center justify-center",children:(0,t.jsx)("span",{className:"text-background text-sm",children:"S"})})}),"loading"===u&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)(a.Loader2,{className:"w-12 h-12 animate-spin text-primary mx-auto"}),(0,t.jsx)("p",{className:"text-foreground",children:"Авторизация через Telegram..."}),(0,t.jsx)("p",{className:"text-muted-foreground text-sm",children:"Пожалуйста, подождите"})]}),"success"===u&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)(s.CheckCircle2,{className:"w-12 h-12 text-green-500 mx-auto"}),(0,t.jsx)("p",{className:"text-foreground",children:"Вход выполнен успешно!"}),(0,t.jsx)("p",{className:"text-muted-foreground text-sm",children:"Перенаправление в личный кабинет..."})]}),"error"===u&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)(i.XCircle,{className:"w-12 h-12 text-red-500 mx-auto"}),(0,t.jsx)("p",{className:"text-foreground",children:"Ошибка авторизации"}),(0,t.jsx)("p",{className:"text-red-400 text-sm",children:m}),(0,t.jsx)("button",{onClick:()=>e.push("/login"),className:"mt-4 bg-primary text-primary-foreground px-6 py-2 text-sm hover:bg-primary/80 transition-colors",children:"Вернуться к входу"})]})]})]})}function u(){return(0,t.jsx)(r.Suspense,{fallback:(0,t.jsxs)("div",{className:"min-h-screen flex items-center justify-center bg-background relative overflow-hidden",children:[(0,t.jsx)(c.PixelStars,{}),(0,t.jsxs)("div",{className:"flex flex-col items-center gap-4 relative z-10",children:[(0,t.jsx)(a.Loader2,{className:"w-12 h-12 animate-spin text-primary"}),(0,t.jsx)("p",{className:"text-foreground",children:"Загрузка..."})]})]}),children:(0,t.jsx)(l,{})})}e.s(["default",()=>u])}]);